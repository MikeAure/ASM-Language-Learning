assume cs:code, ds:data, ss:stack

data segment
    db 10 dup(0)
data ends

stack segment
    db 20h dup(0)
stack ends

code segment

    start:

        mov ax, stack
        mov ss, ax
        mov sp, 20h

        mov ax, 4f40h
        mov dx, 2
        mov cx, 10
        ;mov ds, bx
        mov si,0
        call dwtoc
        
        mov dh, 8
        mov dl, 3
        mov cl, 2
        call show_str

    mov ax, 4c00h
    int 21h



    capital:

        push cx
        push si
    change:
        
        mov ch, 0
        mov cl, [si]
        jcxz ok
        and byte ptr [si], 11011111b
        inc si
        jmp short change

    ok:

        pop si
        pop cx
        ret



    show_str:

         push dx                 ;ä¿å­˜è¡Œå·åˆ—å·
         push ax
         push es
         push bx
         push si
         push di
         push cx
    
        mov ax, 0b800h  
        mov es, ax              ;ä¿å­˜æ˜¾ç¤ºåŒºåŸŸçš„é¦–åœ°å€

        sub dh, 1               ;è¡Œå·åˆ—å·å‡ä¸€ä¾¿äºæ¥ä¸‹æ¥è®¡ç®—æ˜¾ç¤ºåŒºåŸŸqçš„åç§»é‡
        sub dl, 1

        mov al, 0a0h            ;è®¡ç®—è¡Œåç§»é‡
        mul dh
        push ax                 ;ä¿å­˜è¡Œåç§»é‡
        mov al, 2h              ;è®¡ç®—åˆ—åç§»é‡
        mul dl
        pop dx                  ;æ¢å¤è¡Œåç§»é‡ï¼Œå¹¶ä¸åˆ—åç§»é‡ç´¯åŠ 
        add ax, dx              
        mov di, ax              ;å°†æ˜¾ç¤ºåŒºåŸŸçš„æ€»åç§»é‡ä¿å­˜è‡³å˜å€å¯„å­˜å™¨di
        mov ah, cl              ;å°†å­—ç¬¦ä¸²æ ¼å¼å‚æ•°ä¿å­˜è‡³bl

    display:

        mov ch, 0               ;chå¯„å­˜å™¨ç”¨äºåˆ¤æ–­ä½•æ—¶é€€å‡ºå¾ªç¯
        mov cl, [si]         ;é«˜8ä½ä¸º0ï¼Œä½8ä½ä¸ºå½“å‰å­—ç¬¦ï¼Œé‡0åœæ­¢
        jcxz ok2
        mov al, data:[si]   
        mov word ptr es:[di], ax    ;ç§»è‡³æ˜¾ç¤ºåŒºåŸŸå†…å­˜
        inc si                      ;æŒ‡å‘æ•°æ®åŒºä¸‹ä¸€ä¸ªå­—èŠ‚
        add di, 2                   ;æŒ‡å‘æ˜¾ç¤ºåŒºä¸‹ä¸¤ä¸ªå­—èŠ‚
        jmp short display           ;å¾ªç¯

    ok2:

        pop cx
        pop di
        pop si
        pop bx
        pop es
        pop ax
        pop dx                    ;æ¢å¤dxå€¼ï¼Œæ¸…ç©ºæ ˆ
        ret


    divdw:

        push ax
        mov ax, dx
        mov dx, 0
        div cx
        mov bx, ax
        pop ax
        div cx
        mov cx, dx                  ;å­˜å‚¨è®¡ç®—ç»“æœçš„ä½™æ•°
        mov dx,bx
        ret


    dtoc:

        push si
        push ax
        push dx
        push cx
        push di
        push bx

        
        mov bx, 10

    loopl:

        mov dx, 0
        div bx
        mov cx, ax
        jcxz last
        add dx, 30h
        push dx
        inc si
        jmp short loopl

    last:

        add dx, 30h
        push dx
        inc si

        mov cx, si
        mov si, 0

    sl:
        pop ds:[si]
        inc si
        loop sl

    exit_dtoc:

        pop bx
        pop di
        pop cx
        pop dx
        pop ax
        pop si
        ret


    dwtoc:
        push bx
        push cx
        push ax
        push si

    ok4:

        mov cx, 10
        call divdw
        add cx, 30h
        push cx
        inc si
        cmp dx, 0       ;æ­¤å¤„ç”¨cmpï¼Œå®åœ¨ä¸çŸ¥é“æ€ä¹ˆç”¨jcxzğŸ¤¦â€
        je cmp_ax
        jmp ok4

    cmp_ax:

        cmp ax, 0
        je last2
        jmp ok4
    last2:

        ;add cx, 30h    ;ç”¨cmpå°±ä¸å¿…åƒdtocé‚£æ ·å†ä¿å­˜ä¸€é
        ;push cx
        ; inc si

        mov cx, si
        mov si, 0

    sk:

        pop ds:[si]
        inc si
        loop sk

    exit_dwtoc:

        pop si
        pop ax
        pop cx
        pop bx
        ret

        
        
code ends

end start